import{j as a,d as N}from"./dayjs.min-1f63c8fc.js";import{r as h}from"./index-76fb7be0.js";import{c as V,g as A}from"./_commonjsHelpers-de833af9.js";const W="_wrapper_12y2l_1",E="_spacer_12y2l_7",O="_container_12y2l_10",R="_item_12y2l_15",F="_text_12y2l_19",G="_border_12y2l_27",y={wrapper:W,spacer:E,container:O,item:R,text:F,border:G},B=[...Array(24)],w=()=>a.jsxs("div",{className:y.wrapper,children:[a.jsx("div",{className:y.spacer}),a.jsx("div",{className:y.container,children:B.map((e,t)=>a.jsxs("div",{className:y.item,children:[a.jsx("span",{className:y.text,children:t}),a.jsx("span",{className:y.border})]},t))})]});try{w.displayName="CalendarTimelineIndicator",w.__docgenInfo={description:"",displayName:"CalendarTimelineIndicator",props:{}}}catch{}const P="_wrapper_a3m2a_1",U="_container_a3m2a_6",$={wrapper:P,container:U},Y="_wrapper_le793_1",z="_weekend_le793_8",H="_date_le793_14",J="_container_le793_20",K="_background_le793_24",L="_item_le793_30",Q="_schedule_le793_46",g={wrapper:Y,weekend:z,date:H,container:J,background:K,item:L,schedule:Q};var M={exports:{}};(function(e,t){(function(r,s){e.exports=s()})(V,function(){return function(r,s,o){s.prototype.isBetween=function(n,p,i,l){var u=o(n),_=o(p),f=(l=l||"()")[0]==="(",c=l[1]===")";return(f?this.isAfter(u,i):!this.isBefore(u,i))&&(c?this.isBefore(_,i):!this.isAfter(_,i))||(f?this.isBefore(u,i):!this.isAfter(u,i))&&(c?this.isAfter(_,i):!this.isBefore(_,i))}}})})(M);var X=M.exports;const Z=A(X);N.extend(Z);const ee=(e,t)=>{const r=[],s=[];for(const o of t){if(o.isAllDay){e.isBetween(o.startDate,o.endDate,"day","[]")&&r.push(o);continue}e.isBetween(o.startTime,o.endTime,"day","[]")&&s.push(o)}return{dateSchedule:r,timeSchedule:s}},I=24*60*60,te=(e,t)=>{const r=[...e],s=t.startTime.get("h")*3600+t.startTime.get("m")*60+t.startTime.get("s"),n=t.endTime.get("h")*3600+t.endTime.get("m")*60+t.endTime.get("s")-s;let p=0,i=0;for(const l of r){if(l===t){p=i,i++;continue}(t.startTime.isBetween(l.startTime,l.endTime,"m","[]")||l.startTime.isBetween(t.startTime,t.endTime,"m","[]"))&&i++}return{top:`${s/I*100}%`,height:`${n/I*100}%`,width:`${100/i}%`,left:`${100*p/i}%`,backgroundColor:`${t.color}`}},ne=["日","月","火","水","木","金","土"],re="_wrapper_1sv2w_1",ae={wrapper:re},se=24*60*60,j=()=>{const e=()=>{const s=N();return(s.get("h")*3600+s.get("m")*60+s.get("s"))/se},[t,r]=h.useState(e());return h.useEffect(()=>{const s=setInterval(()=>{r(e())},6e4);return()=>{clearInterval(s)}},[]),a.jsx("div",{className:ae.wrapper,style:{top:`${t*100}%`}})};try{j.displayName="CalendarTimelineCurrentTimeIndicator",j.__docgenInfo={description:"",displayName:"CalendarTimelineCurrentTimeIndicator",props:{}}}catch{}const ie="_wrapper_4gkff_1",oe="_metadata_4gkff_6",b={wrapper:ie,metadata:oe},x=({schedule:e,schedules:t})=>a.jsxs("div",{className:b.wrapper,style:te(t,e),children:[e.name,a.jsx("div",{className:b.metadata,children:a.jsx("a",{target:"_blank",href:e.url,children:"リンク"})})]},e.url);try{x.displayName="CalendarTimelineScheduleIndicator",x.__docgenInfo={description:"",displayName:"CalendarTimelineScheduleIndicator",props:{schedules:{defaultValue:null,description:"",name:"schedules",required:!0,type:{name:"TTimeSchedule[]"}},schedule:{defaultValue:null,description:"",name:"schedule",required:!0,type:{name:"TTimeSchedule"}}}}}catch{}const v=h.createContext(void 0),ce="_background_57x4x_1",le={background:ce},de=(e,t)=>{const r=e.set("hour",0).set("minute",0).set("second",0).set("millisecond",0),s=t.set("hour",0).set("minute",0).set("second",0).set("millisecond",0);return r==null?void 0:r.diff(s,"days")},C=()=>{var u,_;const e=h.useContext(v),t=(u=e==null?void 0:e.selectingDate)==null?void 0:u.pos1,r=(_=e==null?void 0:e.selectingDate)==null?void 0:_.pos2;if(!t||!r)return null;const s=de(t,r),o=t.get("hour")*60+t.get("minute"),n=r.get("hour")*60+r.get("minute"),p=Math.min(o,n),i=Math.max(o,n),l={width:`calc((100% + 1px) * ${Math.abs(s)+1})`,left:`calc((100% + 1px) * ${s>0?s*-1:0})`,top:`${p/1440*100}%`,height:`${(i-p)/1440*100}%`};return a.jsx("div",{className:le.background,style:l})};try{C.displayName="CalendarTimelineSelectingIndicator",C.__docgenInfo={description:"",displayName:"CalendarTimelineSelectingIndicator",props:{}}}catch{}const S=({date:e,schedules:t})=>{const r=e.get("day");return a.jsx(a.Fragment,{children:a.jsxs("div",{className:`${g.wrapper} ${(r===0||r===6)&&g.weekend}`,children:[a.jsxs("div",{className:g.date,children:[e.get("date")," (",ne[r],")"]}),a.jsx(pe,{date:e,schedules:t})]})})},pe=({date:e,schedules:t})=>{var f;const r=t&&ee(e,t).timeSchedule,s=e.isSame(N(),"day"),o=h.useRef(null),n=h.useContext(v),p=e.isSame((f=n==null?void 0:n.selectingDate)==null?void 0:f.pos1,"day"),i=c=>{var D;const d=(D=o.current)==null?void 0:D.getBoundingClientRect();if(!d)return;const m=(c.clientY-d.top)/d.height,T=Math.floor(m*24),q=Math.floor((m*24-T)*2)*30;return e.set("hour",T).set("minute",q).set("second",0).set("millisecond",0)},l=c=>{const d=i(c);n==null||n.setSelectingDate(m=>({...m,pos1:d}))},u=c=>{var m;if(!((m=n==null?void 0:n.selectingDate)!=null&&m.pos1))return;const d=i(c);n==null||n.setSelectingDate(T=>({...T,pos2:d}))},_=c=>{var m;if(!((m=n==null?void 0:n.selectingDate)!=null&&m.pos1))return;const d=i(c);d&&(n==null||n.setSelectingDate({}),n==null||n.dispatchOnChange(n.selectingDate.pos1,d))};return a.jsxs("div",{className:g.container,onMouseDown:l,onMouseUp:_,onMouseMove:u,ref:o,children:[a.jsx("div",{className:g.background,children:B.map((c,d)=>a.jsx("div",{className:g.item},d))}),r==null?void 0:r.map(c=>a.jsx(x,{schedules:r,schedule:c})),s&&a.jsx(j,{}),p&&a.jsx(C,{})]})};try{S.displayName="CalendarTimelineWrapper",S.__docgenInfo={description:"",displayName:"CalendarTimelineWrapper",props:{schedules:{defaultValue:null,description:"",name:"schedules",required:!1,type:{name:"TSchedule[]"}},date:{defaultValue:null,description:"",name:"date",required:!0,type:{name:"Dayjs"}}}}}catch{}const k=({count:e,startDate:t,schedules:r,dispatchOnChange:s})=>{const[o,n]=h.useState(void 0);return a.jsx(v.Provider,{value:{selectingDate:o,setSelectingDate:n,dispatchOnChange:s},children:a.jsx("div",{className:$.wrapper,children:a.jsxs("div",{className:$.container,children:[a.jsx(w,{}),[...Array(e)].map((p,i)=>a.jsx(S,{date:t.add(i,"day"),schedules:r},i))]})})})};try{k.displayName="CalendarWrapper",k.__docgenInfo={description:"",displayName:"CalendarWrapper",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},startDate:{defaultValue:null,description:"",name:"startDate",required:!0,type:{name:"Dayjs"}},schedules:{defaultValue:null,description:"",name:"schedules",required:!1,type:{name:"TSchedule[]"}},dispatchOnChange:{defaultValue:null,description:"",name:"dispatchOnChange",required:!0,type:{name:"(pos1: Dayjs, pos2: Dayjs) => void"}}}}}catch{}export{k as C};
//# sourceMappingURL=wrapper-d53b27cc.js.map
